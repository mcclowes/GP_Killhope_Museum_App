<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <script type="text/javascript" src="js/index.js"></script>
        <meta name="format-detection" content="telephone=no" />
        <meta name="msapplication-tap-highlight" content="no" />
        <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <link rel="stylesheet" type="text/css" href="css/style.css" />
        <title>Killhope App</title>
        
        <script type="text/javascript" src="../plugins/jQuery/jquery-2.1.3.min.js"></script>
        <script type="text/javascript">
        
			$(document).ready(function() {
				//$(".app").css("background-image", "url(\"img/minerals/sphalerite/1.JPG\")");
			});
			
			var url = location.href;
			var parameters = url.split("?")[1];
			var current_page = parameters.replace("page=","");
        	
        	var minerals;
        	var glossary = {};

        	glossary["lustre"] = "Lustre is the way light interacts with the surface of a crystal, rock, or mineral. The word traces its origins back to the latin lux, meaning 'light', and generally implies radiance, gloss, or brilliance.";
        	glossary["hardness"] = "The degree of hardness is determined by observing the comparative ease or difficulty which which one mineral is scratched by another.";

	        var test = jQuery.getJSON("info/mineralInfo.json", function(data){
	        	console.log("success");
	        	minerals = data.minerals;
	        	loadMineral(current_page);

	        })
	        .fail(function( jqxhr, textStatus, error ) {
    			var err = textStatus + ", " + error;
    			console.log( "Request Failed: " + err );
    		});
    		
	        function loadMineral(i){
	        	$('#title_minerals').text(minerals[i].name);
	        	$('.info_list').append('<li class="mineral_info_icons"><a href="3d_model_view.html?page=' + i + '"><img src="img/camera_icon.png"></a><a href="mineral_images.php">3D</a></li>');
	        	$('.info_list').append('<li class="mineral_info"><span class="bold">Formula:</span>' + ' ' + minerals[i].formula + '</li>');
	        	for (var name in minerals[i].stage1) {
	        		$('.info_list').append('<li class="mineral_info"><span class="bold">' + name + ': </span>' + minerals[i].stage1[name] + '</li>');
				}
	        	$('.info_list').append('<li class="mineral_info" id="more_info" onclick="nextStage('+i+', 2)">More info</li>');
	        	changeColour(minerals[i].boxcolour);
	        	$(".app").css("background-image", "url(\"img/minerals/"+ minerals[i].mainimgpath+ "\")");
	        	//$('.info_list').animate({ scrollTop: 0 }, "fast");
	        }
	        
	        function nextStage(i, stage) {
	        	$('#more_info').remove();
				for (var name in minerals[i]['stage'+stage]) {
					if (minerals[i]['stage'+stage][name] != "") $('.info_list').append('<li class="mineral_info"><span class="bold">' + name + ': </span>' + minerals[i]['stage'+stage][name] + '</li>');
				}
	        	if (stage != 4) $('.info_list').append('<li class="mineral_info" id="more_info" onclick="nextStage('+i+', '+(stage+1)+')">More info</li>');
	        	changeColour(minerals[i].boxcolour);
	        }

	        function changeColour(c){
	        	$('.mineral_info').css("background-color", c);
	        	$('#title_minerals').css("background-color", c);
	        	$('.mineral_info_icons').css("background-color", c);
	        }

	        function searchGlossary(term){
	        	return glossary[term];
	        }

	        $(document).on('click','#gloss',function(){
		    	var term = $(this).text().toLowerCase();
		    	term = term.substring(0, term.length - 1);
		    	var definiton = searchGlossary(term);
		    	alert(definiton);
			});

	        function back(){
	        	location.href = "mineral_list.html";
	        }

        </script>

        
    </head>
    <body>
        <div class="app">
        	<div class="content">
				<h2 id='title_minerals' onclick='back()'></h2>
				<ul class="info_list">
				</ul>
			</div>

        </div>
        <!--
        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
        -->
    </body>
</html>
