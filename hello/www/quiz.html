<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="msapplication-tap-highlight" content="no" />
        <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <link rel="stylesheet" type="text/css" href="css/style.css" />
        <title>Killhope App</title>
        
        <script type="text/javascript" src="../plugins/jQuery/jquery-2.1.3.min.js"></script>
        <script type="text/javascript">

			$(document).ready(function() {
				$(".app").css("background-image", "url(\"img/minerals/sphalerite/1.JPG\")");
			});
			
			current_answer = null;
			current_question = 0;
			correct = 0;
        	var questions;

	        var test = jQuery.getJSON("info/quiz.json", function(data){
	        	console.log("success");
	        	questions = data.questions;
				loadQuestion(current_question);
	        })
	        .fail(function( jqxhr, textStatus, error ) {
    			var err = textStatus + ", " + error;
    			console.log( "Request Failed: " + err );
    		});
    		
    		function select(number) {
    			current_answer = number;
    			//Deselect current question
    			$(".quiz li:nth-child(n)").css("opacity", "1");
    			//Select new one
    			$(".quiz li:nth-child("+ (number+2) +")").css("opacity", "0.5");
    		}

	        function next(){
    			if (current_answer == questions[current_question].answer) {
    				correct++;
    				current_answer = null;
    			}
    			
	        	if (current_question == questions.length - 1) {
	        		finishQuiz();
	        		current_question = 0;
	        	}
	        	else {
	        		current_question += 1;
	        		loadQuestion(current_question);
	        	}
	        }

	        function back(){
	        	if (current_question == 0) location.href = "index.html";
	        	else {
	        		current_question -= 1;
	        		loadQuestion(current_question);
	        	}
	        }
	        
	        function loadQuestion(number) {
	        	$("ul").empty();
	        	$('#title').text('Question ' + (number+1));
	        	$('.quiz').append('<li class="quiz_item"><span class="bold">' + questions[number].question + '</span></li>');
	        	for (var j = 0; j < questions[number].answers.length; j++) {
	        		$('.quiz').append('<li class="quiz_item" onclick="select(' + j + ')"><span class="bold">' + (j+1) + ' - ' + questions[number].answers[j] + '</span></li>');
	        	}
	        }
	        
	        function finishQuiz() {
	        	$("ul").empty();
	        	$('#title').text('End of quiz ' + correct + '/' + questions.length);
	        	$('#quiz_tick').hide();
	        }
	        
        </script>

        
    </head>
    <body>
        <script>

		</script>
        
        <div class="app">
        	<div class="content">
				<h2 id='title_quiz'><span class="bold" id="back_button" onclick="back()"><-</span><span id="title"> </span></h2>
				<ul class="quiz">
				</ul>
				<p id='quiz_tick' onclick="next()">Next</p>
			</div>
        </div>
        <!--
        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
        -->
    </body>
</html>
